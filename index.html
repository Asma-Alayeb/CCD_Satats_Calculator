<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hypothesis Testing for Two-Pop-Proportions</title>
</head>
<body>
    <h1>Hypothesis Testing for Two Population Proportions</h1>

    <section class="calculator">
        <h2>Calculate Confidence Interval</h2>
        <form id="ciForm">
            <p>Sample Proportion 1 (p̂1): <input type="text" id="ci_p1" required></p>
            <p>Sample Proportion 2 (p̂2): <input type="text" id="ci_p2" required></p>
            <p>Sample Size 1 (n1): <input type="text" id="ci_n1" required></p>
            <p>Sample Size 2 (n2): <input type="text" id="ci_n2" required></p>
            <p>Confidence Level (%): <input type="text" id="ci_confidence_level" required></p>
            <button type="button" onclick="calculateConfidenceInterval()">Calculate Confidence Interval</button>
        </form>
        <p id="ci_result"></p>
    </section>

    <script>
        function roundToFour(value) {
            return Math.round(value * 10000) / 10000;
        }

        function calculateConfidenceInterval() {
            var p1 = parseFloat(document.getElementById("ci_p1").value);
            var p2 = parseFloat(document.getElementById("ci_p2").value);
            var n1 = parseInt(document.getElementById("ci_n1").value);
            var n2 = parseInt(document.getElementById("ci_n2").value);
            var confidenceLevel = parseFloat(document.getElementById("ci_confidence_level").value) / 100;

            if (isNaN(p1) || isNaN(p2) || isNaN(n1) || isNaN(n2) || isNaN(confidenceLevel)) {
                alert("Please ensure all inputs are valid numbers.");
                return;
            }

            var zScore = roundToFour(jStat.normal.inv(1 - (1 - confidenceLevel) / 2, 0, 1));
            var standardError = roundToFour(Math.sqrt((p1 * (1 - p1) / n1) + (p2 * (1 - p2) / n2)));
            var marginOfError = roundToFour(zScore * standardError);

            var lowerBound = roundToFour((p1 - p2) - marginOfError);
            var upperBound = roundToFour((p1 - p2) + marginOfError);

            document.getElementById("ci_result").innerHTML = 
                "Confidence Interval: [" + lowerBound + ", " + upperBound + "]<br>Margin of Error: " + marginOfError;
        }
    </script>
</body>
</html>
